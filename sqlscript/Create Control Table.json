{
	"name": "Create Control Table",
	"properties": {
		"folder": {
			"name": "Control"
		},
		"content": {
			"query": "\n            /****** Object:  Table [control].[MainControlTable_btn] ******/\n            CREATE TABLE [control].[MainControlTable_btn](\n                [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY NONCLUSTERED NOT ENFORCED,\n                [SourceObjectSettings] [nvarchar](max) NULL,\n                [SourceConnectionSettingsName] [varchar](max) NULL,\n                [CopySourceSettings] [nvarchar](max) NULL,\n                [SinkObjectSettings] [nvarchar](max) NULL,\n                [SinkConnectionSettingsName] [varchar](max) NULL,\n                [CopySinkSettings] [nvarchar](max) NULL,\n                [CopyActivitySettings] [nvarchar](max) NULL,\n                [TopLevelPipelineName] [varchar](max) NULL,\n                [TriggerName] [nvarchar](max) NULL,\n                [DataLoadingBehaviorSettings] [nvarchar](max) NULL,\n                [TaskId] [int] NULL,\n                [CopyEnabled] [bit] NULL\n        ) WITH ( HEAP )\n            DECLARE @MainControlMetadata NVARCHAR(max)  = N'[\n    {\n        \"SourceObjectSettings\": {\n            \"schema\": \"Production\",\n            \"table\": \"TransactionHistory\"\n        },\n        \"SinkObjectSettings\": {\n            \"schema\": \"staging\",\n            \"table\": \"Production_TransactionHistory\"\n        },\n        \"CopySourceSettings\": {\n            \"partitionOption\": \"None\",\n            \"sqlReaderQuery\": null,\n            \"partitionLowerBound\": null,\n            \"partitionUpperBound\": null,\n            \"partitionColumnName\": null,\n            \"partitionNames\": null\n        },\n        \"CopySinkSettings\": {\n            \"preCopyScript\": \"TRUNCATE TABLE staging.Production_TransactionHistory\",\n            \"allowPolyBase\": true,\n            \"polyBaseSettings\": {\n                \"rejectValue\": 0,\n                \"rejectType\": \"value\",\n                \"useTypeDefault\": true\n            }\n        },\n        \"CopyActivitySettings\": {\n            \"translator\": {\n                \"type\": \"TabularTranslator\",\n                \"mappings\": [\n                    {\n                        \"source\": {\n                            \"name\": \"TransactionID\",\n                            \"type\": \"Int32\"\n                        },\n                        \"sink\": {\n                            \"name\": \"TransactionID\",\n                            \"type\": \"Int32\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"ProductID\",\n                            \"type\": \"Int32\"\n                        },\n                        \"sink\": {\n                            \"name\": \"ProductID\",\n                            \"type\": \"Int32\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"ReferenceOrderID\",\n                            \"type\": \"Int32\"\n                        },\n                        \"sink\": {\n                            \"name\": \"ReferenceOrderID\",\n                            \"type\": \"Int32\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"ReferenceOrderLineID\",\n                            \"type\": \"Int32\"\n                        },\n                        \"sink\": {\n                            \"name\": \"ReferenceOrderLineID\",\n                            \"type\": \"Int32\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"TransactionDate\",\n                            \"type\": \"DateTime\"\n                        },\n                        \"sink\": {\n                            \"name\": \"TransactionDate\",\n                            \"type\": \"DateTime\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"TransactionType\",\n                            \"type\": \"String\"\n                        },\n                        \"sink\": {\n                            \"name\": \"TransactionType\",\n                            \"type\": \"String\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"Quantity\",\n                            \"type\": \"Int32\"\n                        },\n                        \"sink\": {\n                            \"name\": \"Quantity\",\n                            \"type\": \"Int32\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"ActualCost\",\n                            \"type\": \"Decimal\"\n                        },\n                        \"sink\": {\n                            \"name\": \"ActualCost\",\n                            \"type\": \"Decimal\"\n                        }\n                    },\n                    {\n                        \"source\": {\n                            \"name\": \"ModifiedDate\",\n                            \"type\": \"DateTime\"\n                        },\n                        \"sink\": {\n                            \"name\": \"ModifiedDate\",\n                            \"type\": \"DateTime\"\n                        }\n                    }\n                ]\n            }\n        },\n        \"TopLevelPipelineName\": \"MetadataDrivenCopyTask_btn_TopLevel\",\n        \"TriggerName\": [\n            \"Sandbox\",\n            \"Manual\"\n        ],\n        \"DataLoadingBehaviorSettings\": {\n            \"dataLoadingBehavior\": \"DeltaLoad\",\n            \"watermarkColumnName\": \"ModifiedDate\",\n            \"watermarkColumnType\": \"DateTime\",\n            \"watermarkColumnStartValue\": \"2013-06-01T00:00:00.000Z\"\n        },\n        \"TaskId\": 0,\n        \"CopyEnabled\": 1\n    }\n]';\n            INSERT INTO [control].[MainControlTable_btn] (\n                [SourceObjectSettings],\n                [SourceConnectionSettingsName],\n                [CopySourceSettings],\n                [SinkObjectSettings],\n                [SinkConnectionSettingsName],\n                [CopySinkSettings],\n                [CopyActivitySettings],\n                [TopLevelPipelineName],\n                [TriggerName],\n                [DataLoadingBehaviorSettings],\n                [TaskId],\n                [CopyEnabled])\n            SELECT * FROM OPENJSON(@MainControlMetadata)\n                WITH ([SourceObjectSettings] [nvarchar](max) AS JSON,\n                [SourceConnectionSettingsName] [varchar](max),\n                [CopySourceSettings] [nvarchar](max) AS JSON,\n                [SinkObjectSettings] [nvarchar](max) AS JSON,\n                [SinkConnectionSettingsName] [varchar](max),\n                [CopySinkSettings] [nvarchar](max) AS JSON,\n                [CopyActivitySettings] [nvarchar](max) AS JSON,\n                [TopLevelPipelineName] [varchar](max),\n                [TriggerName] [nvarchar](max) AS JSON,\n                [DataLoadingBehaviorSettings] [nvarchar](max) AS JSON,\n                [TaskId] [int],\n                [CopyEnabled] [bit])",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQLPool1",
				"poolName": "SQLPool1"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}