{
	"name": "Transform and Insert",
	"properties": {
		"content": {
			"query": "-- Initialize table in CTAS\n\n-- CREATE SCHEMA Production;\n\nCREATE TABLE Production.TransactionHistory \nWITH\n    (\n    DISTRIBUTION = ROUND_ROBIN\n    ,CLUSTERED COLUMNSTORE INDEX\n    )\nAS\n    SELECT TOP 0\n        [TransactionID]\n        ,[ProductID]\n        ,[ReferenceOrderID]\n        ,[ReferenceOrderLineID]\n        ,[TransactionDate]\n        ,CAST([TransactionType] AS NVARCHAR(100)) AS TransactionType\n        ,[Quantity]\n        ,[ActualCost]\n        ,0 AS [CostPerUnit]\n        ,[ModifiedDate]\n    FROM [staging].[Production_TransactionHistory];",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQLPool1",
				"poolName": "SQLPool1"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}